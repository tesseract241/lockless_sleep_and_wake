<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>lockless_wait_and_wake: include/lockless_wait_and_wake.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">lockless_wait_and_wake
   </div>
   <div id="projectbrief">Piggyback on system-level futex functionality to provide (best-case) lockless thread waiting and waking without relying on c++20</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('lockless__wait__and__wake_8hpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">lockless_wait_and_wake.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Piggyback on system-level futex functionality to provide (best-case) lockless thread waiting and waking without relying on c++20.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;atomic&gt;</code><br />
</div>
<p><a href="lockless__wait__and__wake_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe7b8fc7a33f638d2a5966e370188633"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lockless__wait__and__wake_8hpp.html#abe7b8fc7a33f638d2a5966e370188633">sleep</a> (std::atomic_uint32_t &amp;flag, uint32_t expected, uint32_t timeout_milliseconds=0)</td></tr>
<tr class="memdesc:abe7b8fc7a33f638d2a5966e370188633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the current thread to sleep and won't return until woken up. Spurious wake-ups are dealt with internally.  <a href="lockless__wait__and__wake_8hpp.html#abe7b8fc7a33f638d2a5966e370188633">More...</a><br /></td></tr>
<tr class="separator:abe7b8fc7a33f638d2a5966e370188633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409dff5093542b862d1c875b58ca4b6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lockless__wait__and__wake_8hpp.html#a409dff5093542b862d1c875b58ca4b6d">wake_one</a> (std::atomic_uint32_t &amp;flag, uint32_t desired)</td></tr>
<tr class="memdesc:a409dff5093542b862d1c875b58ca4b6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wakes one thread waiting on flag.  <a href="lockless__wait__and__wake_8hpp.html#a409dff5093542b862d1c875b58ca4b6d">More...</a><br /></td></tr>
<tr class="separator:a409dff5093542b862d1c875b58ca4b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f2a538d84e0329d4aa2de830a325912"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lockless__wait__and__wake_8hpp.html#a7f2a538d84e0329d4aa2de830a325912">wake_all</a> (std::atomic_uint32_t &amp;flag, uint32_t desired)</td></tr>
<tr class="memdesc:a7f2a538d84e0329d4aa2de830a325912"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wakes all threads waiting on flag.  <a href="lockless__wait__and__wake_8hpp.html#a7f2a538d84e0329d4aa2de830a325912">More...</a><br /></td></tr>
<tr class="separator:a7f2a538d84e0329d4aa2de830a325912"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Piggyback on system-level futex functionality to provide (best-case) lockless thread waiting and waking without relying on c++20. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abe7b8fc7a33f638d2a5966e370188633" name="abe7b8fc7a33f638d2a5966e370188633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe7b8fc7a33f638d2a5966e370188633">&#9670;&#160;</a></span>sleep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sleep </td>
          <td>(</td>
          <td class="paramtype">std::atomic_uint32_t &amp;&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>expected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeout_milliseconds</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the current thread to sleep and won't return until woken up. Spurious wake-ups are dealt with internally. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flag</td><td>The memory address that has to change for the thread to wake </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">expected</td><td>The value flag has to take before the thread wakes, barring timeout </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_milliseconds</td><td>Whatever happens the thread will wake after this amount of time in milliseconds (it's not real time, so scheduling and CPU minimum time quantum will affect this, it's ensured it won't return <b>before</b> the timeout is expired). <br  />
 0, the default, means no timeout </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="example_8cpp-example.html#a0">example.cpp</a>.</dd>
</dl>

</div>
</div>
<a id="a7f2a538d84e0329d4aa2de830a325912" name="a7f2a538d84e0329d4aa2de830a325912"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f2a538d84e0329d4aa2de830a325912">&#9670;&#160;</a></span>wake_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wake_all </td>
          <td>(</td>
          <td class="paramtype">std::atomic_uint32_t &amp;&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>desired</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wakes all threads waiting on flag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flag</td><td>The memory address the threads you're waking is waiting on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desired</td><td>The value flag has to take to wake the threads, set in a corresponding <a class="el" href="lockless__wait__and__wake_8hpp.html#abe7b8fc7a33f638d2a5966e370188633" title="Sends the current thread to sleep and won&#39;t return until woken up. Spurious wake-ups are dealt with i...">sleep</a> call </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="example_8cpp-example.html#a1">example.cpp</a>.</dd>
</dl>

</div>
</div>
<a id="a409dff5093542b862d1c875b58ca4b6d" name="a409dff5093542b862d1c875b58ca4b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409dff5093542b862d1c875b58ca4b6d">&#9670;&#160;</a></span>wake_one()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wake_one </td>
          <td>(</td>
          <td class="paramtype">std::atomic_uint32_t &amp;&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>desired</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wakes one thread waiting on flag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flag</td><td>The memory address the thread you're waking is waiting on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desired</td><td>The value flag has to take to wake the thread, set in a corresponding <a class="el" href="lockless__wait__and__wake_8hpp.html#abe7b8fc7a33f638d2a5966e370188633">sleep</a> call </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="lockless__wait__and__wake_8hpp.html">lockless_wait_and_wake.hpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
